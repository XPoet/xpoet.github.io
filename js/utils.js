KEEP.initUtils=()=>{KEEP.utils={rootHtmlDom:document.querySelector("html"),pageTopDom:document.querySelector(".page-main-content-top"),scrollProgressBarDom:document.querySelector(".scroll-progress-bar"),pjaxProgressBarDom:document.querySelector(".pjax-progress-bar"),pjaxProgressIcon:document.querySelector(".pjax-progress-icon"),back2TopBtn:document.querySelector(".tool-scroll-to-top"),headerWrapperDom:document.querySelector(".header-wrapper"),innerHeight:window.innerHeight,pjaxProgressBarTimer:null,prevScrollValue:0,fontSizeLevel:0,isHasScrollProgressBar:!1,isHasScrollPercent:!1,isHeaderTransparent:!1,isHideHeader:!0,hasToc:!1,formatDatetime(e=KEEP.themeInfo.defaultDatetimeFormat,t=Date.now()){var o,s,t=new Date(t),r=((/(y+)/.test(e)||/(Y+)/.test(e))&&(e=e.replace(RegExp.$1,(""+t.getFullYear()).substr(4-RegExp.$1.length))),{"M+":t.getMonth()+1,"D+":t.getDate(),"d+":t.getDate(),"H+":t.getHours(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()});for(o in r)new RegExp(`(${o})`).test(e)&&(s=""+r[o],e=e.replace(RegExp.$1,1===RegExp.$1.length?s:("00"+s).substring(s.length)));return e},setHowLongAgoLanguage(e,t){return t.replace(/%s/g,e)},getHowLongAgo(e){var t=KEEP.language_ago,o=Math.floor(e/2592e3/12),s=Math.floor(e/2592e3),r=Math.floor(e/86400/7),a=Math.floor(e/86400),i=Math.floor(e/3600%24),l=Math.floor(e/60%60),e=Math.floor(e%60);return 0<o?this.setHowLongAgoLanguage(o,t.year):0<s?this.setHowLongAgoLanguage(s,t.month):0<r?this.setHowLongAgoLanguage(r,t.week):0<a?this.setHowLongAgoLanguage(a,t.day):0<i?this.setHowLongAgoLanguage(i,t.hour):0<l?this.setHowLongAgoLanguage(l,t.minute):0<e?this.setHowLongAgoLanguage(e,t.second):void 0},initData(){var e=KEEP.theme_config?.scroll||{},t=KEEP.theme_config?.first_screen||{};this.isHasScrollProgressBar=!0===e?.progress_bar,this.isHasScrollPercent=!0===e?.percent,this.isHeaderTransparent=!0===t?.enable&&!window.location.pathname.includes("/page/"),this.isHeaderTransparent||this.headerWrapperDom.classList.remove("transparent-1","transparent-2"),this.isHideHeader=!1!==e?.hide_header},styleHandleWhenScroll(){var e=this.getScrollTop(),t=document.body.scrollHeight||document.documentElement.scrollHeight,o=window.innerHeight||document.documentElement.clientHeight,s=Math.round(e/(t-o)*100)||0;10<e?this.back2TopBtn.classList.add("show"):this.back2TopBtn.classList.remove("show"),this.isHasScrollProgressBar&&this.scrollProgressBarDom&&(t=(e/(t-o)*100).toFixed(3),this.scrollProgressBarDom.style.visibility=0===s?"hidden":"visible",this.scrollProgressBarDom.style.width=t+"%"),this.isHasScrollPercent&&this.back2TopBtn&&(this.back2TopBtn.classList.add("show-percent"),o=this.back2TopBtn.querySelector(".percent"),0===s||void 0===s?this.back2TopBtn.classList.remove("show"):(this.back2TopBtn.classList.add("show"),o.innerHTML=s.toFixed(0),99<s?this.back2TopBtn.classList.add("show-arrow"):this.back2TopBtn.classList.remove("show-arrow"))),e>this.prevScrollValue&&e>this.innerHeight?(this.isHideHeader&&this.pageTopDom.classList.add("hide"),this.isHeaderTransparent&&this.headerWrapperDom.classList.remove("transparent-1","transparent-2")):(this.isHideHeader&&this.pageTopDom.classList.remove("hide"),this.isHeaderTransparent&&(e<=this.headerWrapperDom.getBoundingClientRect().height?(this.headerWrapperDom.classList.remove("transparent-2"),this.headerWrapperDom.classList.add("transparent-1")):e<this.innerHeight&&this.headerWrapperDom.classList.add("transparent-2"))),!0===KEEP.theme_config?.first_screen?.enable&&(e>this.innerHeight-this.pageTopDom.getBoundingClientRect().height?this.pageTopDom.classList.add("reset-color"):this.pageTopDom.classList.remove("reset-color")),this.prevScrollValue=e},registerWindowScroll(){window.addEventListener("scroll",()=>{this.styleHandleWhenScroll(),!0===KEEP.theme_config?.toc?.enable&&KEEP.utils?.tocHelper&&KEEP.utils.tocHelper.activeNav(),KEEP.utils.headerShrink.headerShrink(),KEEP.utils.headerShrink.sideToolsBarShowHandle()})},toggleShowToolsList(){let t=document.querySelector(".side-tools-list");var e=document.querySelector(".tool-toggle-show");e?.hasClickListener||(e.addEventListener("click",e=>{t.classList.toggle("show"),e.stopPropagation()}),e.hasClickListener=!0),t.querySelectorAll(".tools-item").forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation()})}),document.addEventListener("click",()=>{t.classList.contains("show")&&t.classList.remove("show")})},globalFontAdjust(){var e=document.defaultView.getComputedStyle(document.body).fontSize;let t=parseFloat(e);let o=e=>{this.rootHtmlDom.style.setProperty("font-size",t*(1+.05*e)+"px","important"),KEEP.themeInfo.styleStatus.fontSizeLevel=e,KEEP.setStyleStatus()};(e=KEEP.getStyleStatus())&&(this.fontSizeLevel=e.fontSizeLevel,o(this.fontSizeLevel)),document.querySelector(".tool-font-adjust-plus").addEventListener("click",()=>{5!==this.fontSizeLevel&&(this.fontSizeLevel++,o(this.fontSizeLevel))}),document.querySelector(".tool-font-adjust-minus").addEventListener("click",()=>{this.fontSizeLevel<=0||(this.fontSizeLevel--,o(this.fontSizeLevel))})},initHasToc(){0<document.querySelectorAll(".post-toc-wrap .post-toc li").length?(this.hasToc=!0,document.body.classList.add("has-toc")):(this.hasToc=!1,document.body.classList.remove("has-toc"))},getZoomValueOfDom(e){e=Number((e.style?.zoom||"1").replace("%",""));return 1<e?e/100:e},zoomInImage(){let u=40,m=!1,g=0,p=null,v=document.querySelector(".zoom-in-image-mask"),E=v?.querySelector(".zoom-in-image");var e=[...document.querySelectorAll(".keep-markdown-body img"),...document.querySelectorAll(".photo-album-box img")];let t=()=>{m&&(m=!1,g=0,E&&(E.style.transform="scale(1)"),v&&v.classList.remove("show"),setTimeout(()=>{p&&p.classList.remove("hide")},300))};e.length&&(v&&v.addEventListener("click",()=>{t()}),document.addEventListener("scroll",()=>{m&&50<=Math.abs(g-window.scrollY)&&t()}),e.forEach(h=>{h.addEventListener("click",()=>{if(g=window.scrollY,m=!m,s=document.body.offsetWidth,u=s<=500?10:s<=800?20:40,E.setAttribute("src",h.getAttribute("src")),p=h,m){var e,t=p.getBoundingClientRect(),o=this.getZoomValueOfDom(p);for(e in t)t[e]=t[e]*o;var s=t.width,r=t.height,a=t.left,i=t.top,l=document.body.offsetWidth-2*u,n=document.body.offsetHeight-2*u,c=l/s,d=n/r,c=(c<d?c:d)||1,d=l/2-(t.x+s/2)+u,l=n/2-(t.y+r/2)+u;p.classList.add("hide"),v.classList.add("show"),E.style.top=i+"px",E.style.left=a+"px",E.style.width=s+"px",E.style.height=r+"px",E.style.transform=`translateX(${d}px) translateY(${l}px) scale(${c}) `}})}))},pjaxProgressBarStart(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.isHasScrollProgressBar&&this.scrollProgressBarDom.classList.add("hide"),this.pjaxProgressBarDom.style.width="0",this.pjaxProgressIcon.classList.add("show");let e=1;this.pjaxProgressBarDom.classList.add("show"),this.pjaxProgressBarDom.style.width=e+"%",this.pjaxProgressBarTimer=setInterval(()=>{99<(e+=5)&&(e=99),this.pjaxProgressBarDom.style.width=e+"%"},100)},pjaxProgressBarEnd(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.pjaxProgressBarDom.style.width="100%";let t=setTimeout(()=>{this.pjaxProgressBarDom.classList.remove("show"),this.pjaxProgressIcon.classList.remove("show"),this.isHasScrollProgressBar&&this.scrollProgressBarDom.classList.remove("hide");let e=setTimeout(()=>{this.pjaxProgressBarDom.style.width="0",clearTimeout(t),clearTimeout(e)},200)},200)},insertTooltipContent(){let p=KEEP.theme_config.root,v=!0===KEEP.theme_config?.lazyload?.enable,e=()=>{document.querySelectorAll(".tooltip").forEach(e=>{var{tooltipContent:t,tooltipOffsetX:o,tooltipOffsetY:s}=e.dataset;let r="";o&&(r+=`left: ${o};`),s&&(r+=`top: ${s};`),r=r&&`style="${r}"`,t&&e.insertAdjacentHTML("afterbegin",`<span class="tooltip-content" ${r}>${t}</span>`)});let g={};document.querySelectorAll(".tooltip-img").forEach((s,r)=>{var a,i,{tooltipImgName:l,tooltipImgUrl:n,tooltipImgTip:c,tooltipImgTrigger:d="click",tooltipImgStyle:h}=s.dataset;let u="",m=(h&&(u=`style="${h}"`),"");if(c&&(m=`<div class="tip">${c}</div>`),n){let t=`tooltip-img-${r}-`+(l||Date.now()),o=l+"-"+r;h=(/^(https?:\/\/)/.test(n)?"":p)+n,c=`<img class="${t}"
                              ${v?"lazyload":""}
                              ${v?"data-":""}src="${h}"
                              alt="${t}"
                            >`,l=`<div ${u} class="tooltip-img-box ${m?"has-tip":""}">${c}${m}</div>`;g[o]={imgLoaded:!1,isShowImg:!1},s.insertAdjacentHTML("afterbegin",l);let e="hover"===d?"mouseover":"click";s?.hasEventListener||(s.addEventListener(e,e=>{v&&!g[o].imgLoaded&&(e=>{var t=new Image;let o=e.dataset.src;t.src=o,t.onload=()=>{e.src=o,e.removeAttribute("lazyload")}})(document.querySelector(".tooltip-img-box img."+t),g[o].imgLoaded),g[o].isShowImg=!g[o].isShowImg,s.classList.toggle("show-img"),e.stopPropagation()}),s.hasEventListener=!0),[a,i,r="click"]=[s,o,d],"hover"===r&&(r="mouseout"),document.addEventListener(r,()=>{g[i].isShowImg&&(a.classList.remove("show-img"),g[i].isShowImg=!1)})}})};setTimeout(()=>{e()},1e3)},siteCountInitialize(){if(!0===KEEP.theme_config?.website_count?.busuanzi_count?.enable){var t="busuanzi-js";let e=document.body.querySelector("#"+t),s=(e||((e=document.createElement("script")).setAttribute("data-pjax",""),e.setAttribute("id",t),e.async=!0,e.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",document.body.appendChild(e)),e=>document.querySelector(e)?.innerText);e.onload=()=>{setTimeout(()=>{var e,t,o;(s("#busuanzi_value_site_uv")||s("#busuanzi_value_site_pv")||s("#busuanzi_value_page_pv"))&&(e=document.querySelector(".footer .count-info .uv"),t=document.querySelector(".footer .count-info .pv"),o=document.querySelector(".post-meta-info .post-pv"),e&&(e.style.display="flex"),t&&(t.style.display="flex"),o)&&(o.style.display="inline-block")},1e3)}}},pageNumberJump(){let o=document.querySelector(".paginator .page-number-input");if(!o)return;let e=document.querySelector(".paginator .first-page"),t=document.querySelector(".paginator .last-page"),s=Number(o.min),r=Number(o.max),a="not-allow",i=(e.addEventListener("click",()=>{e.classList.contains(a)||(o.value=s,i())}),t.addEventListener("click",()=>{t.classList.contains(a)||(o.value=r,i())}),()=>{let e=Number(o.value);e<=0&&(o.value=s,e=s),e>r&&(o.value=r,e=r);var t=window.location.href.replace(/\/$/,"").split("/page/")[0];1===e?window.location.href=t:window.location.href=t+"/page/"+e});o.addEventListener("change",e=>{i()})},tabsActiveHandle(){var e=document.querySelectorAll(".keep-tabs");e.length&&e.forEach(e=>{let r=e.querySelectorAll(".tabs-nav .tab"),a=e.querySelectorAll(".tabs-content .tab-pane");r.forEach(s=>{s.addEventListener("click",()=>{var e,t,o;e=r,t=a,o=s,e.forEach(e=>{o.dataset.href===e.dataset.href?e.classList.add("active"):e.classList.remove("active")}),t.forEach(e=>{o.dataset.href===e.id?e.classList.add("active"):e.classList.remove("active")})})})})},removeWhitespace(e){if(e){var t,o=e.childNodes,s=[];for(let e=0;e<o.length;e++){var r=o[e];3===r.nodeType&&/^\s*$/.test(r.nodeValue)&&s.push(r)}for(t of s)e.removeChild(t)}},trimPostMetaInfoBar(){this.removeWhitespace(document.querySelector(".post-meta-info-container .post-category-ul")),this.removeWhitespace(document.querySelector(".post-meta-info-container .post-tag-ul"))},wrapTableWithBox(){document.querySelectorAll("table").forEach(e=>{var t=document.createElement("div");t.className="table-container",e.wrap(t)})},title2Top4HTag(o,s,r,a){o&&s&&(o?.hasEventListener||(o.addEventListener("click",e=>{e.preventDefault(),a&&a();e=(e=window.scrollY)<=1?-19:e;let t=s.getBoundingClientRect().top+e;e=this.headerWrapperDom.getBoundingClientRect().height,this.isHideHeader||(t-=e),e=this.getFullPageHeight();e<=window.innerHeight||window.anime({targets:document.scrollingElement,duration:r,easing:"linear",scrollTop:t,complete:()=>{history.pushState(null,document.title,o.href),this.isHideHeader&&setTimeout(()=>{this.pageTopDom.classList.add("hide")},160)}})}),o.hasEventListener=!0))},aAnchorJump(){document.querySelectorAll("a.headerlink").forEach(e=>{this.title2Top4HTag(e,e.parentNode,10)}),document.querySelectorAll("a.markdownIt-Anchor").forEach(e=>{this.title2Top4HTag(e,e.parentNode,10)})},getScrollTop(){return document.body.scrollTop||document.documentElement.scrollTop},getFullPageHeight(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}},KEEP.utils.initData(),KEEP.utils.registerWindowScroll(),KEEP.utils.toggleShowToolsList(),KEEP.utils.globalFontAdjust(),KEEP.utils.initHasToc(),KEEP.utils.siteCountInitialize(),KEEP.utils.pageNumberJump(),KEEP.utils.trimPostMetaInfoBar(),KEEP.utils.insertTooltipContent(),KEEP.utils.zoomInImage(),KEEP.utils.tabsActiveHandle(),KEEP.utils.wrapTableWithBox(),KEEP.utils.aAnchorJump()};